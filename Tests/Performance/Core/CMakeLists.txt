function(PerformanceTest NAME SPEED DEPS)
    set(TEST "PTest${NAME}")
    message(STATUS "P -----------------> ${TEST} ${NAME}.cpp ${DEPS}")
    add_executable(${TEST} ${NAME}.cpp ${DEPS})
    target_link_libraries(${TEST} BornAgainCore)
    if((${SPEED} STREQUAL "fast") OR SLOWTESTS)
        add_test(Core:Perf:${NAME} ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/${TEST})
    endif()
endfunction()

PerformanceTest(CoreIO "slow" ../Benchmark.cpp)
PerformanceTest(Multilayer "fast" "")
PerformanceTest(Mesocrystal "fast" "")
PerformanceTest(Threading "slow" ThreadingComponents.cpp)
